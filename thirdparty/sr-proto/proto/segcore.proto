syntax = "proto3";
package milvus.proto.segcore;

option java_package = "com.jd.ninen.pb";
option java_outer_classname = "Segcore";
option java_multiple_files = true;
option java_generate_equals_and_hash = true;

import "schema.proto";
import "common.proto";

message RetrieveData {
  common.Status status = 1;
  RetrieveResults results = 2;
}


message RetrieveResults {
  schema.IDs ids = 1;
  repeated int64 offset = 2;
  repeated schema.FieldData fields_data = 3;
}

message LoadFieldMeta {
  int64 min_timestamp = 1;
  int64 max_timestamp = 2;
  int64 row_count = 3;
}

message LoadSegmentMeta {
  int64 collectionID = 1;
  int64 partitionID = 2;
  int64 segmentID = 3;
  // (start, end]
  int64 timestamp_lower_bound = 4;
  int64 timestamp_upper_bound = 5;
  repeated LoadFieldMeta metas = 6;
  int64 total_size = 7;
}

message InsertRecord {
  repeated schema.FieldData fields_data = 1;
  int64 num_rows = 2;
}

enum RawDataState {
  NotExported = 0;        // Do not export rawdata
  OnlyExported = 1;       // Export rawdata, but do not load online
  ExportedAndLoaded = 2;  // Export rawdata, and load online
}

message FieldIndexMeta {
  int64 fieldID = 1;
  int64 collectionID = 2;
  string index_name = 3;
  repeated common.KeyValuePair type_params = 4;
  repeated common.KeyValuePair index_params = 5;
  bool is_auto_index = 6;
  repeated common.KeyValuePair user_index_params = 7;
  RawDataState raw_data_state = 8;
}

message CollectionIndexMeta {
  int64 maxIndexRowCount = 1;
  repeated FieldIndexMeta index_metas = 2;
}
